var noblePostQuantum=(()=>{var Ve=Object.defineProperty;var Es=Object.getOwnPropertyDescriptor;var Hs=Object.getOwnPropertyNames;var ks=Object.prototype.hasOwnProperty;var Ts=(e,t)=>{for(var n in t)Ve(e,n,{get:t[n],enumerable:!0})},Bs=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Hs(t))!ks.call(e,r)&&r!==n&&Ve(e,r,{get:()=>t[r],enumerable:!(s=Es(t,r))||s.enumerable});return e};var Ls=e=>Bs(Ve({},"__esModule",{value:!0}),e);var dr={};Ts(dr,{ml_dsa44:()=>os,ml_dsa65:()=>cs,ml_dsa87:()=>is,ml_kem1024:()=>ns,ml_kem512:()=>ts,ml_kem768:()=>es,slh_dsa_sha2_128f:()=>ys,slh_dsa_sha2_128s:()=>gs,slh_dsa_sha2_192f:()=>As,slh_dsa_sha2_192s:()=>ws,slh_dsa_sha2_256f:()=>ms,slh_dsa_sha2_256s:()=>_s,slh_dsa_shake_128f:()=>fs,slh_dsa_shake_128s:()=>ds,slh_dsa_shake_192f:()=>hs,slh_dsa_shake_192s:()=>ls,slh_dsa_shake_256f:()=>us,slh_dsa_shake_256s:()=>ps});var ke=BigInt(4294967295),bn=BigInt(32);function Ss(e,t=!1){return t?{h:Number(e&ke),l:Number(e>>bn&ke)}:{h:Number(e>>bn&ke)|0,l:Number(e&ke)|0}}function Te(e,t=!1){let n=e.length,s=new Uint32Array(n),r=new Uint32Array(n);for(let o=0;o<n;o++){let{h:c,l:i}=Ss(e[o],t);[s[o],r[o]]=[c,i]}return[s,r]}var Ye=(e,t,n)=>e>>>n,Xe=(e,t,n)=>e<<32-n|t>>>n,jt=(e,t,n)=>e>>>n|t<<32-n,Vt=(e,t,n)=>e<<32-n|t>>>n,he=(e,t,n)=>e<<64-n|t>>>n-32,le=(e,t,n)=>e>>>n-32|t<<64-n;var yn=(e,t,n)=>e<<n|t>>>32-n,gn=(e,t,n)=>t<<n|e>>>32-n,An=(e,t,n)=>t<<n-32|e>>>64-n,wn=(e,t,n)=>e<<n-32|t>>>64-n;function Ot(e,t,n,s){let r=(t>>>0)+(s>>>0);return{h:e+n+(r/2**32|0)|0,l:r|0}}var mn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),_n=(e,t,n,s)=>t+n+s+(e/2**32|0)|0,En=(e,t,n,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Hn=(e,t,n,s,r)=>t+n+s+r+(e/2**32|0)|0,kn=(e,t,n,s,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0)+(r>>>0),Tn=(e,t,n,s,r,o)=>t+n+s+r+o+(e/2**32|0)|0;function Os(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ue(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function gt(e,...t){if(!Os(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Ln(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ue(e.outputLen),ue(e.blockLen)}function Ut(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Be(e,t){gt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Le(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function wt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Yt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bt(e,t){return e<<32-t|e>>>t}var Cs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Is(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Us(e){for(let t=0;t<e.length;t++)e[t]=Is(e[t]);return e}var Ze=Cs?e=>e:Us,Sn=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Rs=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Fn(e){if(gt(e),Sn)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Rs[e[n]];return t}var It={_0:48,_9:57,A:65,F:70,a:97,f:102};function Bn(e){if(e>=It._0&&e<=It._9)return e-It._0;if(e>=It.A&&e<=It.F)return e-(It.A-10);if(e>=It.a&&e<=It.f)return e-(It.a-10)}function Se(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Sn)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let s=new Uint8Array(n);for(let r=0,o=0;r<n;r++,o+=2){let c=Bn(e.charCodeAt(o)),i=Bn(e.charCodeAt(o+1));if(c===void 0||i===void 0){let d=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}s[r]=c*16+i}return s}function Xt(...e){let t=0;for(let s=0;s<e.length;s++){let r=e[s];gt(r),t+=r.length}let n=new Uint8Array(t);for(let s=0,r=0;s<e.length;s++){let o=e[s];n.set(o,r),r+=o.length}return n}function Ct(e){let t=(s,r)=>e(r).update(s).digest(),n=e(void 0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=s=>e(s),t}function On(e=32){let t=typeof globalThis!=null&&globalThis.crypto;if(!t||typeof t.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}var Ms=BigInt(0),pe=BigInt(1),Ps=BigInt(2),Ks=BigInt(7),Ds=BigInt(256),Ns=BigInt(113),Un=[],Rn=[],Mn=[];for(let e=0,t=pe,n=1,s=0;e<24;e++){[n,s]=[s,(2*n+3*s)%5],Un.push(2*(5*s+n)),Rn.push((e+1)*(e+2)/2%64);let r=Ms;for(let o=0;o<7;o++)t=(t<<pe^(t>>Ks)*Ns)%Ds,t&Ps&&(r^=pe<<(pe<<BigInt(o))-pe);Mn.push(r)}var Pn=Te(Mn,!0),Gs=Pn[0],Ws=Pn[1],Cn=(e,t,n)=>n>32?An(e,t,n):yn(e,t,n),In=(e,t,n)=>n>32?wn(e,t,n):gn(e,t,n);function vs(e,t=24){let n=new Uint32Array(10);for(let s=24-t;s<24;s++){for(let c=0;c<10;c++)n[c]=e[c]^e[c+10]^e[c+20]^e[c+30]^e[c+40];for(let c=0;c<10;c+=2){let i=(c+8)%10,d=(c+2)%10,y=n[d],w=n[d+1],f=Cn(y,w,1)^n[i],x=In(y,w,1)^n[i+1];for(let p=0;p<50;p+=10)e[c+p]^=f,e[c+p+1]^=x}let r=e[2],o=e[3];for(let c=0;c<24;c++){let i=Rn[c],d=Cn(r,o,i),y=In(r,o,i),w=Un[c];r=e[w],o=e[w+1],e[w]=d,e[w+1]=y}for(let c=0;c<50;c+=10){for(let i=0;i<10;i++)n[i]=e[c+i];for(let i=0;i<10;i++)e[c+i]^=~n[(i+2)%10]&n[(i+4)%10]}e[0]^=Gs[s],e[1]^=Ws[s]}wt(n)}var Fe=class e{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(t,n,s,r=!1,o=24){if(this.blockLen=t,this.suffix=n,this.outputLen=s,this.enableXOF=r,this.rounds=o,ue(s),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Le(this.state)}clone(){return this._cloneInto()}keccak(){Ze(this.state32),vs(this.state32,this.rounds),Ze(this.state32),this.posOut=0,this.pos=0}update(t){Ut(this),gt(t);let{blockLen:n,state:s}=this,r=t.length;for(let o=0;o<r;){let c=Math.min(n-this.pos,r-o);for(let i=0;i<c;i++)s[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:s,blockLen:r}=this;t[s]^=n,n&128&&s===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){Ut(this,!1),gt(t),this.finish();let n=this.state,{blockLen:s}=this;for(let r=0,o=t.length;r<o;){this.posOut>=s&&this.keccak();let c=Math.min(s-this.posOut,o-r);t.set(n.subarray(this.posOut,this.posOut+c),r),this.posOut+=c,r+=c}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return ue(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Be(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,wt(this.state)}_cloneInto(t){let{blockLen:n,suffix:s,outputLen:r,rounds:o,enableXOF:c}=this;return t||=new e(n,s,r,c,o),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=s,t.outputLen=r,t.enableXOF=c,t.destroyed=this.destroyed,t}},Oe=(e,t,n)=>Ct(()=>new Fe(t,e,n)),Kn=Oe(6,144,224/8),Ce=Oe(6,136,256/8),Dn=Oe(6,104,384/8),Ie=Oe(6,72,512/8);var Nn=(e,t,n)=>Ct((s={})=>new Fe(t,e,s.dkLen===void 0?n:s.dkLen,!0)),Ue=Nn(31,168,128/8),q=Nn(31,136,256/8);function $e(e){if(!Number.isSafeInteger(e)||e<0||e>4294967295)throw new Error("wrong u32 integer:"+e);return e}function Wn(e){return $e(e),(e&e-1)===0&&e!==0}function ze(e,t){$e(e);let n=0;for(let s=0;s<t;s++,e>>>=1)n=n<<1|e&1;return n}function vn(e){return $e(e),31-Math.clz32(e)}function Gn(e){let t=e.length;if(t<2||!Wn(t))throw new Error("n must be a power of 2 and greater than 1. Got "+t);let n=vn(t);for(let s=0;s<t;s++){let r=ze(s,n);if(s<r){let o=e[s];e[s]=e[r],e[r]=o}}return e}var qe=(e,t)=>{let{add:n,sub:s,mul:r}=e,{N:o,roots:c,dit:i,invertButterflies:d=!1,skipStages:y=0,brp:w=!0}=t,f=vn(o);if(!Wn(o))throw new Error("FFT: Polynomial size should be power of two");let x=i!==d;return p=>{if(p.length!==o)throw new Error("FFT: wrong Polynomial length");i&&w&&Gn(p);for(let I=0,U=1;I<f-y;I++){let S=i?I+1+y:f-I,P=1<<S,b=P>>1,h=o>>S;for(let T=0;T<o;T+=P)for(let R=0,W=U++;R<b;R++){let E=d?i?o-W:W:R*h,N=T+R,M=T+R+b,v=c[E],D=p[M],Q=p[N];if(x){let ot=r(D,v);p[N]=n(Q,ot),p[M]=s(Q,ot)}else d?(p[N]=n(D,Q),p[M]=r(s(D,Q),v)):(p[N]=n(Q,D),p[M]=r(s(Q,D),v))}}return!i&&w&&Gn(p),p}};function jn(e,t,n){return e&t^~e&n}function Vn(e,t,n){return e&t^e&n^t&n}var xe=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,s,r){this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=r,this.buffer=new Uint8Array(t),this.view=Yt(this.buffer)}update(t){Ut(this),gt(t);let{view:n,buffer:s,blockLen:r}=this,o=t.length;for(let c=0;c<o;){let i=Math.min(r-this.pos,o-c);if(i===r){let d=Yt(t);for(;r<=o-c;c+=r)this.process(d,c);continue}s.set(t.subarray(c,c+i),this.pos),this.pos+=i,c+=i,this.pos===r&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ut(this),Be(t,this),this.finished=!0;let{buffer:n,view:s,blockLen:r,isLE:o}=this,{pos:c}=this;n[c++]=128,wt(this.buffer.subarray(c)),this.padOffset>r-c&&(this.process(s,0),c=0);for(let f=c;f<r;f++)n[f]=0;s.setBigUint64(r-8,BigInt(this.length*8),o),this.process(s,0);let i=Yt(t),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let y=d/4,w=this.get();if(y>w.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<y;f++)i.setUint32(4*f,w[f],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:n,buffer:s,length:r,finished:o,destroyed:c,pos:i}=this;return t.destroyed=c,t.finished=o,t.length=r,t.pos=i,r%n&&t.buffer.set(s),t}clone(){return this._cloneInto()}},Rt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Mt=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),ct=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),it=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var js=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Dt=new Uint32Array(64),Re=class extends xe{constructor(t){super(64,t,8,!1)}get(){let{A:t,B:n,C:s,D:r,E:o,F:c,G:i,H:d}=this;return[t,n,s,r,o,c,i,d]}set(t,n,s,r,o,c,i,d){this.A=t|0,this.B=n|0,this.C=s|0,this.D=r|0,this.E=o|0,this.F=c|0,this.G=i|0,this.H=d|0}process(t,n){for(let f=0;f<16;f++,n+=4)Dt[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){let x=Dt[f-15],p=Dt[f-2],I=Bt(x,7)^Bt(x,18)^x>>>3,U=Bt(p,17)^Bt(p,19)^p>>>10;Dt[f]=U+Dt[f-7]+I+Dt[f-16]|0}let{A:s,B:r,C:o,D:c,E:i,F:d,G:y,H:w}=this;for(let f=0;f<64;f++){let x=Bt(i,6)^Bt(i,11)^Bt(i,25),p=w+x+jn(i,d,y)+js[f]+Dt[f]|0,U=(Bt(s,2)^Bt(s,13)^Bt(s,22))+Vn(s,r,o)|0;w=y,y=d,d=i,i=c+p|0,c=o,o=r,r=s,s=p+U|0}s=s+this.A|0,r=r+this.B|0,o=o+this.C|0,c=c+this.D|0,i=i+this.E|0,d=d+this.F|0,y=y+this.G|0,w=w+this.H|0,this.set(s,r,o,c,i,d,y,w)}roundClean(){wt(Dt)}destroy(){this.set(0,0,0,0,0,0,0,0),wt(this.buffer)}},Qe=class extends Re{A=Rt[0]|0;B=Rt[1]|0;C=Rt[2]|0;D=Rt[3]|0;E=Rt[4]|0;F=Rt[5]|0;G=Rt[6]|0;H=Rt[7]|0;constructor(){super(32)}},Je=class extends Re{A=Mt[0]|0;B=Mt[1]|0;C=Mt[2]|0;D=Mt[3]|0;E=Mt[4]|0;F=Mt[5]|0;G=Mt[6]|0;H=Mt[7]|0;constructor(){super(28)}},Yn=Te(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Vs=Yn[0],Ys=Yn[1],Nt=new Uint32Array(80),Gt=new Uint32Array(80),ne=class extends xe{constructor(t){super(128,t,16,!1)}get(){let{Ah:t,Al:n,Bh:s,Bl:r,Ch:o,Cl:c,Dh:i,Dl:d,Eh:y,El:w,Fh:f,Fl:x,Gh:p,Gl:I,Hh:U,Hl:S}=this;return[t,n,s,r,o,c,i,d,y,w,f,x,p,I,U,S]}set(t,n,s,r,o,c,i,d,y,w,f,x,p,I,U,S){this.Ah=t|0,this.Al=n|0,this.Bh=s|0,this.Bl=r|0,this.Ch=o|0,this.Cl=c|0,this.Dh=i|0,this.Dl=d|0,this.Eh=y|0,this.El=w|0,this.Fh=f|0,this.Fl=x|0,this.Gh=p|0,this.Gl=I|0,this.Hh=U|0,this.Hl=S|0}process(t,n){for(let h=0;h<16;h++,n+=4)Nt[h]=t.getUint32(n),Gt[h]=t.getUint32(n+=4);for(let h=16;h<80;h++){let T=Nt[h-15]|0,R=Gt[h-15]|0,W=jt(T,R,1)^jt(T,R,8)^Ye(T,R,7),E=Vt(T,R,1)^Vt(T,R,8)^Xe(T,R,7),N=Nt[h-2]|0,M=Gt[h-2]|0,v=jt(N,M,19)^he(N,M,61)^Ye(N,M,6),D=Vt(N,M,19)^le(N,M,61)^Xe(N,M,6),Q=En(E,D,Gt[h-7],Gt[h-16]),ot=Hn(Q,W,v,Nt[h-7],Nt[h-16]);Nt[h]=ot|0,Gt[h]=Q|0}let{Ah:s,Al:r,Bh:o,Bl:c,Ch:i,Cl:d,Dh:y,Dl:w,Eh:f,El:x,Fh:p,Fl:I,Gh:U,Gl:S,Hh:P,Hl:b}=this;for(let h=0;h<80;h++){let T=jt(f,x,14)^jt(f,x,18)^he(f,x,41),R=Vt(f,x,14)^Vt(f,x,18)^le(f,x,41),W=f&p^~f&U,E=x&I^~x&S,N=kn(b,R,E,Ys[h],Gt[h]),M=Tn(N,P,T,W,Vs[h],Nt[h]),v=N|0,D=jt(s,r,28)^he(s,r,34)^he(s,r,39),Q=Vt(s,r,28)^le(s,r,34)^le(s,r,39),ot=s&o^s&i^o&i,At=r&c^r&d^c&d;P=U|0,b=S|0,U=p|0,S=I|0,p=f|0,I=x|0,{h:f,l:x}=Ot(y|0,w|0,M|0,v|0),y=i|0,w=d|0,i=o|0,d=c|0,o=s|0,c=r|0;let Lt=mn(v,Q,At);s=_n(Lt,M,D,ot),r=Lt|0}({h:s,l:r}=Ot(this.Ah|0,this.Al|0,s|0,r|0)),{h:o,l:c}=Ot(this.Bh|0,this.Bl|0,o|0,c|0),{h:i,l:d}=Ot(this.Ch|0,this.Cl|0,i|0,d|0),{h:y,l:w}=Ot(this.Dh|0,this.Dl|0,y|0,w|0),{h:f,l:x}=Ot(this.Eh|0,this.El|0,f|0,x|0),{h:p,l:I}=Ot(this.Fh|0,this.Fl|0,p|0,I|0),{h:U,l:S}=Ot(this.Gh|0,this.Gl|0,U|0,S|0),{h:P,l:b}=Ot(this.Hh|0,this.Hl|0,P|0,b|0),this.set(s,r,o,c,i,d,y,w,f,x,p,I,U,S,P,b)}roundClean(){wt(Nt,Gt)}destroy(){wt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},tn=class extends ne{Ah=it[0]|0;Al=it[1]|0;Bh=it[2]|0;Bl=it[3]|0;Ch=it[4]|0;Cl=it[5]|0;Dh=it[6]|0;Dl=it[7]|0;Eh=it[8]|0;El=it[9]|0;Fh=it[10]|0;Fl=it[11]|0;Gh=it[12]|0;Gl=it[13]|0;Hh=it[14]|0;Hl=it[15]|0;constructor(){super(64)}},en=class extends ne{Ah=ct[0]|0;Al=ct[1]|0;Bh=ct[2]|0;Bl=ct[3]|0;Ch=ct[4]|0;Cl=ct[5]|0;Dh=ct[6]|0;Dl=ct[7]|0;Eh=ct[8]|0;El=ct[9]|0;Fh=ct[10]|0;Fl=ct[11]|0;Gh=ct[12]|0;Gl=ct[13]|0;Hh=ct[14]|0;Hl=ct[15]|0;constructor(){super(48)}},dt=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),ht=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),nn=class extends ne{Ah=dt[0]|0;Al=dt[1]|0;Bh=dt[2]|0;Bl=dt[3]|0;Ch=dt[4]|0;Cl=dt[5]|0;Dh=dt[6]|0;Dl=dt[7]|0;Eh=dt[8]|0;El=dt[9]|0;Fh=dt[10]|0;Fl=dt[11]|0;Gh=dt[12]|0;Gl=dt[13]|0;Hh=dt[14]|0;Hl=dt[15]|0;constructor(){super(28)}},sn=class extends ne{Ah=ht[0]|0;Al=ht[1]|0;Bh=ht[2]|0;Bl=ht[3]|0;Ch=ht[4]|0;Cl=ht[5]|0;Dh=ht[6]|0;Dl=ht[7]|0;Eh=ht[8]|0;El=ht[9]|0;Fh=ht[10]|0;Fl=ht[11]|0;Gh=ht[12]|0;Gl=ht[13]|0;Hh=ht[14]|0;Hl=ht[15]|0;constructor(){super(32)}},se=Ct(()=>new Qe),Xn=Ct(()=>new Je),Me=Ct(()=>new tn),Zn=Ct(()=>new en),$n=Ct(()=>new sn),zn=Ct(()=>new nn);var J=gt,Zt=On;function $t(e,t){if(e.length!==t.length)return!1;let n=0;for(let s=0;s<e.length;s++)n|=e[s]^t[s];return n===0}function rt(...e){let t=s=>typeof s=="number"?s:s.bytesLen,n=e.reduce((s,r)=>s+t(r),0);return{bytesLen:n,encode:s=>{let r=new Uint8Array(n);for(let o=0,c=0;o<e.length;o++){let i=e[o],d=t(i),y=typeof i=="number"?s[o]:i.encode(s[o]);J(y,d),r.set(y,c),typeof i!="number"&&y.fill(0),c+=d}return r},decode:s=>{J(s,n);let r=[];for(let o of e){let c=t(o),i=s.subarray(0,c);r.push(typeof o=="number"?i:o.decode(i)),s=s.subarray(c)}return r}}}function bt(e,t){let n=t*e.bytesLen;return{bytesLen:n,encode:s=>{if(s.length!==t)throw new Error(`vecCoder.encode: wrong length=${s.length}. Expected: ${t}`);let r=new Uint8Array(n);for(let o=0,c=0;o<s.length;o++){let i=e.encode(s[o]);r.set(i,c),i.fill(0),c+=i.length}return r},decode:s=>{J(s,n);let r=[];for(let o=0;o<s.length;o+=e.bytesLen)r.push(e.decode(s.subarray(o,o+e.bytesLen)));return r}}}function $(...e){for(let t of e)if(Array.isArray(t))for(let n of t)n.fill(0);else t.fill(0)}function re(e){return(1<<e)-1}var _t=new Uint8Array(0);function oe(e,t=_t){if(J(e),J(t),t.length>255)throw new Error("context should be less than 255 bytes");return Xt(new Uint8Array([0,t.length]),t,e)}var mt=e=>Se("06096086480165030402"+e),qn={"SHA2-256":{oid:mt("01"),hash:se},"SHA2-384":{oid:mt("02"),hash:Zn},"SHA2-512":{oid:mt("03"),hash:Me},"SHA2-224":{oid:mt("04"),hash:Xn},"SHA2-512/224":{oid:mt("05"),hash:zn},"SHA2-512/256":{oid:mt("06"),hash:$n},"SHA3-224":{oid:mt("07"),hash:Kn},"SHA3-256":{oid:mt("08"),hash:Ce},"SHA3-384":{oid:mt("09"),hash:Dn},"SHA3-512":{oid:mt("0A"),hash:Ie},"SHAKE-128":{oid:mt("0B"),hash:e=>Ue(e,{dkLen:32})},"SHAKE-256":{oid:mt("0C"),hash:e=>q(e,{dkLen:64})}};function ce(e,t,n=_t){if(J(t),J(n),n.length>255)throw new Error("context should be less than 255 bytes");if(!qn[e])throw new Error("unknown hash: "+e);let{oid:s,hash:r}=qn[e],o=r(t);return Xt(new Uint8Array([1,n.length]),n,s,o)}var Pe=e=>{let{newPoly:t,N:n,Q:s,F:r,ROOT_OF_UNITY:o,brvBits:c,isKyber:i}=e,d=(b,h=s)=>{let T=b%h|0;return(T>=0?T|0:h+T|0)|0},y=(b,h=s)=>{let T=d(b,h)|0;return(T>h>>1?T-h|0:T)|0};function w(){let b=t(n);for(let h=0;h<n;h++){let T=ze(h,c),R=BigInt(o)**BigInt(T)%BigInt(s);b[h]=Number(R)|0}return b}let f=w(),x={add:(b,h)=>d((b|0)+(h|0))|0,sub:(b,h)=>d((b|0)-(h|0))|0,mul:(b,h)=>d((b|0)*(h|0))|0,inv:b=>{throw new Error("not implemented")}},p={N:n,roots:f,invertButterflies:!0,skipStages:i?1:0,brp:!1},I=qe(x,{dit:!1,...p}),U=qe(x,{dit:!0,...p});return{mod:d,smod:y,nttZetas:f,NTT:{encode:b=>I(b),decode:b=>{U(b);for(let h=0;h<b.length;h++)b[h]=d(r*b[h]);return b}},bitsCoder:(b,h)=>{let T=re(b),R=b*(n/8);return{bytesLen:R,encode:W=>{let E=new Uint8Array(R);for(let N=0,M=0,v=0,D=0;N<W.length;N++)for(M|=(h.encode(W[N])&T)<<v,v+=b;v>=8;v-=8,M>>=8)E[D++]=M&re(v);return E},decode:W=>{let E=t(n);for(let N=0,M=0,v=0,D=0;N<W.length;N++)for(M|=W[N]<<v,v+=8;v>=b;v-=b,M>>=b)E[D++]=h.decode(M&T);return E}}}}},Qn=e=>(t,n)=>{n||(n=e.blockLen);let s=new Uint8Array(t.length+2);s.set(t);let r=t.length,o=new Uint8Array(n),c=e.create({}),i=0,d=0;return{stats:()=>({calls:i,xofs:d}),get:(y,w)=>(s[r+0]=y,s[r+1]=w,c.destroy(),c=e.create({}).update(s),i++,()=>(d++,c.xofInto(o))),clean:()=>{c.destroy(),$(o,s)}}},ie=Qn(Ue),Ke=Qn(q);var lt=256,Pt=3329,Xs=3303,Zs=17,{mod:ge,nttZetas:$s,NTT:zt,bitsCoder:zs}=Pe({N:lt,Q:Pt,F:Xs,ROOT_OF_UNITY:Zs,newPoly:e=>new Uint16Array(e),brvBits:7,isKyber:!0}),rn={512:{N:lt,Q:Pt,K:2,ETA1:3,ETA2:2,du:10,dv:4,RBGstrength:128},768:{N:lt,Q:Pt,K:3,ETA1:2,ETA2:2,du:10,dv:4,RBGstrength:192},1024:{N:lt,Q:Pt,K:4,ETA1:2,ETA2:2,du:11,dv:5,RBGstrength:256}},qs=e=>{if(e>=12)return{encode:n=>n,decode:n=>n};let t=2**(e-1);return{encode:n=>((n<<e)+Pt/2)/Pt,decode:n=>n*Pt+t>>>e}},be=e=>zs(e,qs(e));function qt(e,t){for(let n=0;n<lt;n++)e[n]=ge(e[n]+t[n])}function Qs(e,t){for(let n=0;n<lt;n++)e[n]=ge(e[n]-t[n])}function Js(e,t,n,s,r){let o=ge(t*s*r+e*n),c=ge(e*s+t*n);return{c0:o,c1:c}}function De(e,t){for(let n=0;n<lt/2;n++){let s=$s[64+(n>>1)];n&1&&(s=-s);let{c0:r,c1:o}=Js(e[2*n+0],e[2*n+1],t[2*n+0],t[2*n+1],s);e[2*n+0]=r,e[2*n+1]=o}return e}function Jn(e){let t=new Uint16Array(lt);for(let n=0;n<lt;){let s=e();if(s.length%3)throw new Error("SampleNTT: unaligned block");for(let r=0;n<lt&&r+3<=s.length;r+=3){let o=(s[r+0]>>0|s[r+1]<<8)&4095,c=(s[r+1]>>4|s[r+2]<<4)&4095;o<Pt&&(t[n++]=o),n<lt&&c<Pt&&(t[n++]=c)}}return t}function ye(e,t,n,s){let r=e(s*lt/4,t,n),o=new Uint16Array(lt),c=Le(r),i=0;for(let d=0,y=0,w=0,f=0;d<c.length;d++){let x=c[d];for(let p=0;p<32;p++)w+=x&1,x>>=1,i+=1,i===s?(f=w,w=0):i===2*s&&(o[y++]=ge(f-w),w=0,i=0)}if(i)throw new Error(`sampleCBD: leftover bits: ${i}`);return o}var tr=e=>{let{K:t,PRF:n,XOF:s,HASH512:r,ETA1:o,ETA2:c,du:i,dv:d}=e,y=be(1),w=be(d),f=be(i),x=rt(bt(be(12),t),32),p=bt(be(12),t),I=rt(bt(f,t),w),U=rt(32,32);return{secretCoder:p,secretKeyLen:p.bytesLen,publicKeyLen:x.bytesLen,cipherTextLen:I.bytesLen,keygen:S=>{J(S,32);let P=new Uint8Array(33);P.set(S),P[32]=t;let b=r(P),[h,T]=U.decode(b),R=[],W=[];for(let M=0;M<t;M++)R.push(zt.encode(ye(n,T,M,o)));let E=s(h);for(let M=0;M<t;M++){let v=zt.encode(ye(n,T,t+M,o));for(let D=0;D<t;D++){let Q=Jn(E.get(D,M));qt(v,De(Q,R[D]))}W.push(v)}E.clean();let N={publicKey:x.encode([W,h]),secretKey:p.encode(R)};return $(h,T,R,W,P,b),N},encrypt:(S,P,b)=>{let[h,T]=x.decode(S),R=[];for(let D=0;D<t;D++)R.push(zt.encode(ye(n,b,D,o)));let W=s(T),E=new Uint16Array(lt),N=[];for(let D=0;D<t;D++){let Q=ye(n,b,t+D,c),ot=new Uint16Array(lt);for(let At=0;At<t;At++){let Lt=Jn(W.get(D,At));qt(ot,De(Lt,R[At]))}qt(Q,zt.decode(ot)),N.push(Q),qt(E,De(h[D],R[D])),$(ot)}W.clean();let M=ye(n,b,2*t,c);qt(M,zt.decode(E));let v=y.decode(P);return qt(v,M),$(h,R,E,M),I.encode([N,v])},decrypt:(S,P)=>{let[b,h]=I.decode(S),T=p.decode(P),R=new Uint16Array(lt);for(let W=0;W<t;W++)qt(R,De(T[W],zt.encode(b[W])));return Qs(h,zt.decode(R)),$(R,T,b),y.encode(h)}}};function on(e){let t=tr(e),{HASH256:n,HASH512:s,KDF:r}=e,{secretCoder:o,cipherTextLen:c}=t,i=t.publicKeyLen,d=rt(t.secretKeyLen,t.publicKeyLen,32,32),y=d.bytesLen,w=32;return{publicKeyLen:i,msgLen:w,keygen:(f=Zt(64))=>{J(f,64);let{publicKey:x,secretKey:p}=t.keygen(f.subarray(0,32)),I=n(x),U=d.encode([p,x,I,f.subarray(32)]);return $(p,I),{publicKey:x,secretKey:U}},encapsulate:(f,x=Zt(32))=>{J(f,i),J(x,w);let p=f.subarray(0,384*e.K),I=o.encode(o.decode(p.slice()));if(!$t(I,p))throw $(I),new Error("ML-KEM.encapsulate: wrong publicKey modulus");$(I);let U=s.create().update(x).update(n(f)).digest(),S=t.encrypt(f,x,U.subarray(32,64));return $(U.subarray(32)),{cipherText:S,sharedSecret:U.subarray(0,32)}},decapsulate:(f,x)=>{J(x,y),J(f,c);let[p,I,U,S]=d.decode(x),P=t.decrypt(f,p),b=s.create().update(P).update(U).digest(),h=b.subarray(0,32),T=t.encrypt(I,P,b.subarray(32,64)),R=$t(f,T),W=r.create({dkLen:32}).update(S).update(f).digest();return $(P,T,R?W:h),R?h:W}}}function er(e,t,n){return q.create({dkLen:e}).update(t).update(new Uint8Array([n])).digest()}var cn={HASH256:Ce,HASH512:Ie,KDF:q,XOF:ie,PRF:er},ts=on({...cn,...rn[512]}),es=on({...cn,...rn[768]}),ns=on({...cn,...rn[1024]});var z=256,Wt=8380417,nr=1753,sr=8347681,te=13,fn=Math.floor((Wt-1)/88)|0,dn=Math.floor((Wt-1)/32)|0,hn={2:{K:4,L:4,D:te,GAMMA1:2**17,GAMMA2:fn,TAU:39,ETA:2,OMEGA:80},3:{K:6,L:5,D:te,GAMMA1:2**19,GAMMA2:dn,TAU:49,ETA:4,OMEGA:55},5:{K:8,L:7,D:te,GAMMA1:2**19,GAMMA2:dn,TAU:60,ETA:2,OMEGA:75}},Et=e=>new Int32Array(e),{mod:Jt,smod:Ne,NTT:pt,bitsCoder:rr}=Pe({N:z,Q:Wt,F:sr,ROOT_OF_UNITY:nr,newPoly:Et,isKyber:!1,brvBits:8}),ss=e=>e,Ae=(e,t=ss,n=ss)=>rr(e,{encode:s=>t(n(s)),decode:s=>n(t(s))}),ae=(e,t)=>{for(let n=0;n<e.length;n++)e[n]=Jt(e[n]+t[n]);return e},rs=(e,t)=>{for(let n=0;n<e.length;n++)e[n]=Jt(e[n]-t[n]);return e},or=e=>{for(let t=0;t<z;t++)e[t]<<=te;return e},we=(e,t)=>{for(let n=0;n<z;n++)if(Math.abs(Ne(e[n]))>=t)return!0;return!1},Qt=(e,t)=>{let n=Et(z);for(let s=0;s<e.length;s++)n[s]=Jt(e[s]*t[s]);return n};function an(e){let t=Et(z);for(let n=0;n<z;){let s=e();if(s.length%3)throw new Error("RejNTTPoly: unaligned block");for(let r=0;n<z&&r<=s.length-3;r+=3){let o=(s[r+0]|s[r+1]<<8|s[r+2]<<16)&8388607;o<Wt&&(t[n++]=o)}}return t}function ln(e){let{K:t,L:n,GAMMA1:s,GAMMA2:r,TAU:o,ETA:c,OMEGA:i}=e,{CRH_BYTES:d,TR_BYTES:y,C_TILDE_BYTES:w,XOF128:f,XOF256:x}=e;if(![2,4].includes(c))throw new Error("Wrong ETA");if(![1<<17,1<<19].includes(s))throw new Error("Wrong GAMMA1");if(![fn,dn].includes(r))throw new Error("Wrong GAMMA2");let p=o*c,I=l=>{let H=Jt(l),g=Ne(H,2*r)|0;return H-g===Wt-1?{r1:0,r0:g-1|0}:{r1:Math.floor((H-g)/(2*r))|0,r0:g}},U=l=>I(l).r1,S=l=>I(l).r0,P=(l,H)=>l<=r||l>Wt-r||l===Wt-r&&H===0?0:1,b=(l,H)=>{let g=Math.floor((Wt-1)/(2*r)),{r1:A,r0:u}=I(H);return l===1?u>0?Jt(A+1,g)|0:Jt(A-1,g)|0:A|0},h=l=>{let H=Jt(l),g=Ne(H,2**te)|0;return{r1:Math.floor((H-g)/2**te)|0,r0:g}},T={bytesLen:i+t,encode:l=>{if(l===!1)throw new Error("hint.encode: hint is false");let H=new Uint8Array(i+t);for(let g=0,A=0;g<t;g++){for(let u=0;u<z;u++)l[g][u]!==0&&(H[A++]=u);H[i+g]=A}return H},decode:l=>{let H=[],g=0;for(let A=0;A<t;A++){let u=Et(z);if(l[i+A]<g||l[i+A]>i)return!1;for(let a=g;a<l[i+A];a++){if(a>g&&l[a]<=l[a-1])return!1;u[l[a]]=1}g=l[i+A],H.push(u)}for(let A=g;A<i;A++)if(l[A]!==0)return!1;return H}},R=Ae(c===2?3:4,l=>c-l,l=>{if(!(-c<=l&&l<=c))throw new Error(`malformed key s1/s3 ${l} outside of ETA range [${-c}, ${c}]`);return l}),W=Ae(13,l=>(1<<te-1)-l),E=Ae(10),N=Ae(s===1<<17?18:20,l=>Ne(s-l)),M=Ae(r===fn?6:4),v=bt(M,t),D=rt(32,bt(E,t)),Q=rt(32,32,y,bt(R,n),bt(R,t),bt(W,t)),ot=rt(w,bt(N,n),T),At=c===2?l=>l<15?2-l%5:!1:l=>l<9?4-l:!1;function Lt(l){let H=Et(z);for(let g=0;g<z;){let A=l();for(let u=0;g<z&&u<A.length;u+=1){let a=At(A[u]&15),m=At(A[u]>>4&15);a!==!1&&(H[g++]=a),g<z&&m!==!1&&(H[g++]=m)}}return H}let me=l=>{let H=Et(z),g=q.create({}).update(l),A=new Uint8Array(q.blockLen);g.xofInto(A);let u=A.slice(0,8);for(let a=z-o,m=8,_=0,k=0;a<z;a++){let B=a+1;for(;B>a;)B=A[m++],!(m<q.blockLen)&&(g.xofInto(A),m=0);H[a]=H[B],H[B]=1-((u[_]>>k++&1)<<1),k>=8&&(_++,k=0)}return H},We=l=>{let H=Et(z),g=Et(z);for(let A=0;A<l.length;A++){let{r0:u,r1:a}=h(l[A]);H[A]=u,g[A]=a}return{r0:H,r1:g}},_e=(l,H)=>{for(let g=0;g<z;g++)l[g]=b(H[g],l[g]);return l},Ee=(l,H)=>{let g=Et(z),A=0;for(let u=0;u<z;u++){let a=P(l[u],H[u]);g[u]=a,A+=a}return{v:g,cnt:A}},ee=32,vt=rt(32,64,32),St={signRandBytes:ee,keygen:l=>{let H=new Uint8Array(34),g=l===void 0;g&&(l=Zt(32)),J(l,32),H.set(l),g&&$(l),H[32]=t,H[33]=n;let[A,u,a]=vt.decode(q(H,{dkLen:vt.bytesLen})),m=x(u),_=[];for(let C=0;C<n;C++)_.push(Lt(m.get(C&255,C>>8&255)));let k=[];for(let C=n;C<n+t;C++)k.push(Lt(m.get(C&255,C>>8&255)));let B=_.map(C=>pt.encode(C.slice())),F=[],G=[],K=f(A),O=Et(z);for(let C=0;C<t;C++){$(O);for(let X=0;X<n;X++){let et=an(K.get(X,C));ae(O,Qt(et,B[X]))}pt.decode(O);let{r0:Z,r1:tt}=We(ae(O,k[C]));F.push(Z),G.push(tt)}let j=D.encode([A,G]),Y=q(j,{dkLen:y}),L=Q.encode([A,a,Y,_,k,F]);return K.clean(),m.clean(),$(A,u,a,_,k,B,O,F,G,Y,H),{publicKey:j,secretKey:L}},sign:(l,H,g,A=!1)=>{let[u,a,m,_,k,B]=Q.decode(l),F=[],G=f(u);for(let L=0;L<t;L++){let C=[];for(let Z=0;Z<n;Z++)C.push(an(G.get(Z,L)));F.push(C)}G.clean();for(let L=0;L<n;L++)pt.encode(_[L]);for(let L=0;L<t;L++)pt.encode(k[L]),pt.encode(B[L]);let K=A?H:q.create({dkLen:d}).update(m).update(H).digest(),O=g||new Uint8Array(32);J(O);let j=q.create({dkLen:d}).update(a).update(O).update(K).digest();J(j,d);let Y=x(j,N.bytesLen);t:for(let L=0;;){let C=[];for(let V=0;V<n;V++,L++)C.push(N.decode(Y.get(L&255,L>>8)()));let Z=C.map(V=>pt.encode(V.slice())),tt=[];for(let V=0;V<t;V++){let nt=Et(z);for(let st=0;st<n;st++)ae(nt,Qt(F[V][st],Z[st]));pt.decode(nt),tt.push(nt)}let X=tt.map(V=>V.map(U)),et=q.create({dkLen:w}).update(K).update(v.encode(X)).digest(),xt=pt.encode(me(et)),yt=_.map(V=>Qt(V,xt));for(let V=0;V<n;V++)if(ae(pt.decode(yt[V]),C[V]),we(yt[V],s-p))continue t;let Kt=0,Tt=[];for(let V=0;V<t;V++){let nt=pt.decode(Qt(k[V],xt)),st=rs(tt[V],nt).map(S);if(we(st,r-p))continue t;let Ft=pt.decode(Qt(B[V],xt));if(we(Ft,r))continue t;ae(st,Ft);let ft=Ee(st,X[V]);Tt.push(ft.v),Kt+=ft.cnt}if(Kt>i)continue;Y.clean();let at=ot.encode([et,yt,Tt]);return $(et,yt,Tt,xt,X,tt,Z,C,j,K,_,k,B,...F),at}throw new Error("Unreachable code path reached, report this error")},verify:(l,H,g,A=!1)=>{let[u,a]=D.decode(l),m=q(l,{dkLen:y});if(g.length!==ot.bytesLen)return!1;let[_,k,B]=ot.decode(g);if(B===!1)return!1;for(let L=0;L<n;L++)if(we(k[L],s-p))return!1;let F=A?H:q.create({dkLen:d}).update(m).update(H).digest(),G=pt.encode(me(_)),K=k.map(L=>L.slice());for(let L=0;L<n;L++)pt.encode(K[L]);let O=[],j=f(u);for(let L=0;L<t;L++){let C=Qt(pt.encode(or(a[L])),G),Z=Et(z);for(let X=0;X<n;X++){let et=an(j.get(X,L));ae(Z,Qt(et,K[X]))}let tt=pt.decode(rs(Z,C));O.push(_e(tt,B[L]))}j.clean();let Y=q.create({dkLen:w}).update(F).update(v.encode(O)).digest();for(let L of B)if(!(L.reduce((Z,tt)=>Z+tt,0)<=i))return!1;for(let L of k)if(we(L,s-p))return!1;return $t(_,Y)}};return{internal:St,keygen:St.keygen,signRandBytes:St.signRandBytes,sign:(l,H,g=_t,A)=>{let u=oe(H,g),a=St.sign(l,u,A);return $(u),a},verify:(l,H,g,A=_t)=>St.verify(l,oe(H,A),g),prehash:l=>({sign:(H,g,A=_t,u)=>{let a=ce(l,g,A),m=St.sign(H,a,u);return $(a),m},verify:(H,g,A,u=_t)=>St.verify(H,ce(l,g,u),A)})}}var os=ln({...hn[2],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:32,XOF128:ie,XOF256:Ke}),cs=ln({...hn[3],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:ie,XOF256:Ke}),is=ln({...hn[5],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:64,XOF128:ie,XOF256:Ke});var fe=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(Ln(t),gt(n),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,r=new Uint8Array(s);r.set(n.length>s?t.create().update(n).digest():n);for(let o=0;o<r.length;o++)r[o]^=54;this.iHash.update(r),this.oHash=t.create();for(let o=0;o<r.length;o++)r[o]^=106;this.oHash.update(r),wt(r)}update(t){return Ut(this),this.iHash.update(t),this}digestInto(t){Ut(this),gt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:n,iHash:s,finished:r,destroyed:o,blockLen:c,outputLen:i}=this;return t=t,t.finished=r,t.destroyed=o,t.blockLen=c,t.outputLen=i,t.oHash=n._cloneInto(t.oHash),t.iHash=s._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},cr=(e,t,n)=>new fe(e,t).update(n).digest();cr.create=(e,t)=>new fe(e,t);var Ht={"128f":{W:16,N:16,H:66,D:22,K:33,A:6},"128s":{W:16,N:16,H:63,D:7,K:14,A:12},"192f":{W:16,N:24,H:66,D:22,K:33,A:8},"192s":{W:16,N:24,H:63,D:7,K:17,A:14},"256f":{W:16,N:32,H:68,D:17,K:35,A:9},"256s":{W:16,N:32,H:64,D:8,K:22,A:14}},ut={WOTS:0,WOTSPK:1,HASHTREE:2,FORSTREE:3,FORSPK:4,WOTSPRF:5,FORSPRF:6};function ir(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":"0x"+e)}function as(e){return ir(Fn(e))}function ar(e,t){return Se(e.toString(16).padStart(t*2,"0"))}var un=(e,t)=>{let n=re(t);return s=>{let r=new Uint32Array(e);for(let o=0,c=0,i=0,d=0;o<e;o++){for(;i<t;)d=d<<8|s[c++],i+=8;i-=t,r[o]=d>>>i&n}return r}};function pn(e){return(1n<<BigInt(e))-1n}function kt(e,t){let{N:n,W:s,H:r,D:o,K:c,A:i}=e,d=t.getContext(e);if(s!==16)throw new Error("Unsupported Winternitz parameter");let y=4,w=Math.floor(8*n/y),f=n<=8?2:n<=136?3:4,x=Math.floor(r/o),p=w+f,I=22,U=0,S=1,P=9,b=12,h=13,T=17,R=18,W=21;t.isCompressed||(I=32,U+=3,S+=7,P+=10,b+=10,h+=10,T+=10,R+=10,W+=10);let E=(u,a=new Uint8Array(I))=>{let{type:m,height:_,tree:k,layer:B,index:F,chain:G,hash:K,keypair:O}=u,{subtreeAddr:j,keypairAddr:Y}=u,L=Yt(a);return _!==void 0&&(a[T]=_),B!==void 0&&(a[U]=B),m!==void 0&&(a[P]=m),G!==void 0&&(a[T]=G),K!==void 0&&(a[W]=K),F!==void 0&&L.setUint32(R,F,!1),j&&a.set(j.subarray(0,S+8)),k!==void 0&&L.setBigUint64(S,k,!1),O!==void 0&&(a[h]=O,x>8&&(a[b]=O>>>8)),Y&&(a.set(Y.subarray(0,S+8)),a[h]=Y[h],x>8&&(a[b]=Y[b])),a},N=un(f,y),M=u=>{let a=un(w,y)(u),m=0;for(let B=0;B<a.length;B++)m+=s-1-a[B];m<<=(8-f*y%8)%8;let _=N(ar(m,Math.ceil(f*y/8))),k=new Uint32Array(p);return k.set(a),k.set(_,a.length),k},v=un(c,i),D=x*(o-1),Q=x,ot=rt(Math.ceil(i*c/8),Math.ceil(D/8),Math.ceil(x/8)),At=(u,a,m,_)=>{let k=_.Hmsg(u,a,m,ot.bytesLen),[B,F,G]=ot.decode(k),K=as(F)&pn(D),O=Number(as(G))&re(Q);return{tree:K,leafIdx:O,md:B}},Lt=(u,a)=>function(_,k,B,F,G){let K=(1<<u)-1,O=new Uint8Array(u*n),j=new Uint8Array(u*n);for(let Y=0;;Y++){let L=new Uint8Array(2*n),C=L.subarray(0,n),Z=L.subarray(n),tt=Y+B;Z.set(a(k,tt,_,G));let X=0;for(let et=Y,xt=B,yt=k;;X++,et>>>=1,yt>>>=1,xt>>>=1){if(X===u)return{root:Z,authPath:j};if((et^yt)===1&&j.subarray(X*n).set(Z),!(et&1)&&Y<K)break;E({height:X+1,index:(et>>1)+(xt>>1)},F),C.set(O.subarray(X*n).subarray(0,n)),Z.set(_.thashN(2,L,F))}O.subarray(X*n).set(Z)}throw new Error("Unreachable code path reached, report this error")},me=Lt(x,(u,a,m,_)=>{let k=new Uint8Array(p*n),B=a===u?0:-1>>>0;E({keypair:a},_.leafAddr),E({keypair:a},_.pkAddr);for(let F=0;F<p;F++){let G=_.wotsSteps[F]|B,K=k.subarray(F*n,(F+1)*n);E({chain:F,hash:0,type:ut.WOTSPRF},_.leafAddr),K.set(m.PRFaddr(_.leafAddr)),E({type:ut.WOTS},_.leafAddr);for(let O=0;O===G&&_.wotsSig.subarray(F*n).set(K),O!==s-1;O++)E({hash:O},_.leafAddr),K.set(m.thash1(K,_.leafAddr))}return m.thashN(p,k,_.pkAddr)}),We=Lt(i,(u,a,m,_)=>{E({type:ut.FORSPRF,index:a},_);let k=m.PRFaddr(_);return E({type:ut.FORSTREE},_),m.thash1(k,_)}),_e=(u,a,m,_,k=new Uint8Array(n))=>{E({type:ut.HASHTREE},m);let B={wotsSig:new Uint8Array(H.bytesLen),wotsSteps:M(k),leafAddr:E({subtreeAddr:a}),pkAddr:E({type:ut.WOTSPK,subtreeAddr:a})},{root:F,authPath:G}=me(u,_,0,m,B);return{root:F,sigWots:B.wotsSig.subarray(0,p*n),sigAuth:G}},Ee=(u,a,m,_,k,B,F)=>{let G=new Uint8Array(2*n),K=G.subarray(0,n),O=G.subarray(n,2*n);a&1?(O.set(u.subarray(0,n)),K.set(_.subarray(0,n))):(K.set(u.subarray(0,n)),O.set(_.subarray(0,n))),a>>>=1,m>>>=1;for(let j=0;j<k-1;j++,a>>=1,m>>=1){E({height:j+1,index:a+m},F);let Y=_.subarray((j+1)*n,(j+2)*n);a&1?(O.set(B.thashN(2,G,F)),K.set(Y)):(G.set(B.thashN(2,G,F)),O.set(Y))}return E({height:k,index:a+m},F),B.thashN(2,G,F)},ee=rt(n,n,n),vt=rt(n,n),St=rt(n,n,vt.bytesLen),l=bt(rt(n,n*i),c),H=bt(rt(p*n,x*n),o),g=rt(n,l,H),A={signRandBytes:n,keygen(u){u=u===void 0?Zt(ee.bytesLen):u.slice();let[a,m,_]=ee.decode(u),k=d(_,a),B=E({layer:o-1}),F=E({layer:o-1}),{root:G}=_e(k,F,B,-1>>>0),K=vt.encode([_,G]),O=St.encode([a,m,K]);return k.clean(),$(a,m,G,F,B),{publicKey:K,secretKey:O}},sign:(u,a,m)=>{let[_,k,B]=St.decode(u),[F,G]=vt.decode(B);m||(m=F.slice()),J(m,n);let K=d(F,_),O=K.PRFmsg(k,m,a),{tree:j,leafIdx:Y,md:L}=At(O,B,a,K),C=E({type:ut.WOTS,tree:j,keypair:Y}),Z=[],tt=E({keypairAddr:C}),X=E({keypairAddr:C}),et=v(L),xt=[];for(let nt=0;nt<et.length;nt++){let st=nt<<i;E({type:ut.FORSPRF,height:0,index:et[nt]+st},X);let Ft=K.PRFaddr(X);E({type:ut.FORSTREE},X);let{root:ft,authPath:ve}=We(K,et[nt],st,X,tt);Z.push(ft),xt.push([Ft,ve])}let yt=E({type:ut.FORSPK,keypairAddr:C}),Kt=K.thashN(c,Xt(...Z),yt),Tt=E({type:ut.HASHTREE}),at=[];for(let nt=0;nt<o;nt++,j>>=BigInt(x)){E({tree:j,layer:nt},Tt),E({subtreeAddr:Tt,keypair:Y},C);let{sigWots:st,sigAuth:Ft,root:ft}=_e(K,C,Tt,Y,Kt);Kt.set(ft),$(ft),at.push([st,Ft]),Y=Number(j&pn(x))}K.clean();let V=g.encode([O,xt,at]);return $(O,m,Tt,C,tt,X,et,Z),V},verify:(u,a,m)=>{let[_,k]=vt.decode(u),[B,F,G]=g.decode(m),K=u;if(m.length!==g.bytesLen)return!1;let O=d(_),{tree:j,leafIdx:Y,md:L}=At(B,K,a,O),C=E({type:ut.WOTS,tree:j,keypair:Y}),Z=[],tt=E({type:ut.FORSTREE,keypairAddr:C}),X=v(L);for(let at=0;at<F.length;at++){let[V,nt]=F[at],st=at<<i;E({height:0,index:X[at]+st},tt);let Ft=O.thash1(V,tt);Z.push(Ee(Ft,X[at],st,nt,i,O,tt))}let et=E({type:ut.FORSPK,keypairAddr:C}),xt=O.thashN(c,Xt(...Z),et),yt=E({type:ut.HASHTREE}),Kt=E({type:ut.WOTSPK}),Tt=new Uint8Array(p*n);for(let at=0;at<G.length;at++,j>>=BigInt(x)){let[V,nt]=G[at];E({tree:j,layer:at},yt),E({subtreeAddr:yt,keypair:Y},C),E({keypairAddr:C},Kt);let st=M(xt);for(let ft=0;ft<p;ft++){E({chain:ft},C);let ve=s-1-st[ft],xn=st[ft],je=Tt.subarray(ft*n);je.set(V.subarray(ft*n,(ft+1)*n));for(let He=xn;He<xn+ve&&He<s;He++)E({hash:He},C),je.set(O.thash1(je,C))}let Ft=O.thashN(p,Tt,Kt);xt=Ee(Ft,Y,0,nt,x,O,yt),Y=Number(j&pn(x))}return $t(xt,k)}};return{internal:A,seedLen:ee.bytesLen,keygen:A.keygen,signRandBytes:A.signRandBytes,sign:(u,a,m=_t,_)=>{let k=oe(a,m),B=A.sign(u,k,_);return $(k),B},verify:(u,a,m,_=_t)=>A.verify(u,oe(a,_),m),prehash:u=>({seedLen:ee.bytesLen,keygen:A.keygen,signRandBytes:A.signRandBytes,sign:(a,m,_=_t,k)=>{let B=ce(u,m,_),F=A.sign(a,B,k);return $(B),F},verify:(a,m,_,k=_t)=>A.verify(a,ce(u,m,k),_)})}}var fr=()=>e=>(t,n)=>{let{N:s}=e,r={prf:0,thash:0,hmsg:0,gen_message_random:0},o=q.create({}).update(t),c=o.clone(),i=(d,y,w)=>(r.thash++,o._cloneInto(c).update(w).update(y.subarray(0,d*s)).xof(s));return{PRFaddr:d=>{if(!n)throw new Error("no sk seed");return r.prf++,o._cloneInto(c).update(d).update(n).xof(s)},PRFmsg:(d,y,w)=>(r.gen_message_random++,q.create({}).update(d).update(y).update(w).digest().subarray(0,s)),Hmsg:(d,y,w,f)=>(r.hmsg++,q.create({}).update(d.subarray(0,s)).update(y).update(w).xof(f)),thash1:i.bind(null,1),thashN:i,clean:()=>{o.destroy(),c.destroy()}}},de={getContext:fr()},fs=kt(Ht["128f"],de),ds=kt(Ht["128s"],de),hs=kt(Ht["192f"],de),ls=kt(Ht["192s"],de),us=kt(Ht["256f"],de),ps=kt(Ht["256s"],de),xs=(e,t)=>n=>(s,r)=>{let{N:o}=n,c={prf:0,thash:0,hmsg:0,gen_message_random:0,mgf1:0},i=new Uint8Array(4),d=Yt(i),y=e.create().update(s).update(new Uint8Array(e.blockLen-o)),w=t.create().update(s).update(new Uint8Array(t.blockLen-o)),f=y.clone(),x=w.clone();function p(U,S,P){c.mgf1++;let b=new Uint8Array(Math.ceil(S/P.outputLen)*P.outputLen);if(S>2**32)throw new Error("mask too long");for(let h=0,T=b;T.length;h++)d.setUint32(0,h,!1),P.create().update(U).update(i).digestInto(T),T=T.subarray(P.outputLen);return $(b.subarray(S)),b.subarray(0,S)}let I=(U,S,P)=>(b,h,T)=>(c.thash++,S._cloneInto(P).update(T).update(h.subarray(0,b*o)).digest().subarray(0,o));return{PRFaddr:U=>{if(!r)throw new Error("No sk seed");return c.prf++,y._cloneInto(f).update(U).update(r).digest().subarray(0,o)},PRFmsg:(U,S,P)=>(c.gen_message_random++,new fe(t,U).update(S).update(P).digest().subarray(0,o)),Hmsg:(U,S,P,b)=>{c.hmsg++;let h=Xt(U.subarray(0,o),S.subarray(0,o),t.create().update(U.subarray(0,o)).update(S).update(P).digest());return p(h,b,t)},thash1:I(e,y,f).bind(null,1),thashN:I(t,w,x),clean:()=>{y.destroy(),w.destroy(),f.destroy(),x.destroy()}}},bs={isCompressed:!0,getContext:xs(se,se)},Ge={isCompressed:!0,getContext:xs(se,Me)},ys=kt(Ht["128f"],bs),gs=kt(Ht["128s"],bs),As=kt(Ht["192f"],Ge),ws=kt(Ht["192s"],Ge),ms=kt(Ht["256f"],Ge),_s=kt(Ht["256s"],Ge);return Ls(dr);})();
/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
